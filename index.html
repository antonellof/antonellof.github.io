<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8">

  <title>Fratepietro.com</title>
  <meta name="description" content="Antonello Fratepietro's personal page.">
  <meta name="author" content="Antonello Fratepietro">

  <link rel="stylesheet" href="css/styles.css?v=1.0">

  <!--[if lt IE 9]>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.js"></script>
  <![endif]-->

  <link href="https://fonts.googleapis.com/css?family=Press+Start+2P" rel="stylesheet" type="text/css">
	
    <style>
    body,
    #allWrap {
        background: #000;
        border-radius: 5% / 100%;
        overflow: hidden;
        font-family: "Press Start 2P"
    }
    
    .loader {
        border-radius: 5% / 100%;
        padding: 2%;
        color: #8A7DE5;
        box-shadow: 0 0 10px #352bbe;
        -webkit-transition: all .1s ease;
        background: #352BBE;
        width: 80%;
        height: 90%;
        left: 10%;
        top: 5%;
        position: absolute;
        z-index: 4
    }
    
    #loadTXT {
        margin-top: 1px;
        position: relative;
        display: inline-block;
        word-break: break-all;
        min-height: 1em
    }
    
    #loadTXT:after {
        width: 1em;
        height: 1.1em;
        display: block;
        position: absolute;
        bottom: 0;
        left: 100%;
        background: #8A7DE5;
        content: "";
    }
    
    canvas {
        position: absolute;
        width: 100%;
        height: 100%;
    }
    </style>

</head>

<body>
	<div id="allWrap">
        <div>
            <canvas id="tempCanv"></canvas>
        </div>
        <div class="loader">
            <p style="text-align: center">**** COMMODORE 64 BASIC V2.1 ****
                <br/>
                <br/> 64K RAM SYSTEM 38911 BASIC BYTES FREE
            </p>
            <p>READY.
                <br/><span id="loadTXT"><br/> </span></br>
            </p>
        </div>
    </div>
  <script type="text/javascript">
    var s = {
        canv2: document.getElementById('tempCanv'),
        Loader: {
            ready: false,
            init: function() {
                s.ctx2 = s.canv2.getContext('2d');
                s.canv2.width = 800;
                s.canv2.height = 600;
                s.ctx2.webkitImageSmoothingEnabled = false;
                s.Loader.text(function() {

                });
            },
            c_text: 0,
            dom_text: document.getElementById('loadTXT'),
            text: function(callback) {
                s.Loader.dom_text.innerHTML = s.Loader.TEXT.substring(0, s.Loader.c_text);
                if (s.Loader.c_text <= s.Loader.TEXT.length) {
                    setTimeout(
                        function() {
                            s.Loader.c_text++;
                            s.Loader.text(callback);
                        }, ~~(Math.random() * 100) + 50
                    );
                } else {
                    s.Loader.bars(callback);
                }
            },
            TEXT: 'LOAD "FRATEPIETRO.COM"<br/>   ',
            barsC: 2000,
            bars: function() {
                var c = s.ctx2,
                    x = 200,
                    l = 0,
                    h = s.canv2.height,
                    w = s.canv2.width,
                    random = '<br/><br/><p style="max-height: 88px; overflow: hidden">';

                //c.clearRect(0,0, s.canv2.width, s.canv2.height);

                for (x; x !== 0; x -= 1) {
                    rnd = {
                        r: ~~(Math.random() * 255),
                        g: ~~(Math.random() * 255),
                        b: ~~(Math.random() * 255),
                        y: ~~(Math.random() * h)
                    }
                    c.fillStyle = 'rgba(' + rnd.r + ',' + rnd.g + ',' + rnd.b + ', 1)';
                    c.fillRect(0, rnd.y, w, rnd.y / 20 + 2);
                }

                if (!s.Loader.ready && s.Loader.barsC > 0) {
                    requestAnimationFrame(function() {
                        s.Loader.barsC--;
                        s.Loader.bars();
                    });
                    return;
                } else {
                    for (l = 0; l < 500; l++) {
                        random += String.fromCharCode(Math.ceil(Math.random() * 50) + 62)
                    }


                }

            }

        }
    }
    s.Loader.init();
    </script>
</body>
</html>
